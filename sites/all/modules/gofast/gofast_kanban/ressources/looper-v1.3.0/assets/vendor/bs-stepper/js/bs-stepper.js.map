{"version":3,"file":"bs-stepper.js","sources":["../../src/js/polyfill.js","../../src/js/util.js","../../src/js/listeners.js","../../src/js/index.js"],"sourcesContent":["let matches = window.Element.prototype.matches\nlet closest = (element, selector) => element.closest(selector)\nlet WinEvent = (inType, params) => new window.Event(inType, params)\nlet createCustomEvent = (eventName, params) => {\n  const cEvent = new window.CustomEvent(eventName, params)\n\n  return cEvent\n}\n\n/* istanbul ignore next */\nfunction polyfill () {\n  if (!window.Element.prototype.matches) {\n    matches = window.Element.prototype.msMatchesSelector ||\n      window.Element.prototype.webkitMatchesSelector\n  }\n\n  if (!window.Element.prototype.closest) {\n    closest = (element, selector) => {\n      if (!document.documentElement.contains(element)) {\n        return null\n      }\n\n      do {\n        if (matches.call(element, selector)) {\n          return element\n        }\n\n        element = element.parentElement || element.parentNode\n      } while (element !== null && element.nodeType === 1)\n\n      return null\n    }\n  }\n\n  if (!window.Event || typeof window.Event !== 'function') {\n    WinEvent = (inType, params) => {\n      params = params || {}\n      const e = document.createEvent('Event')\n      e.initEvent(inType, Boolean(params.bubbles), Boolean(params.cancelable))\n      return e\n    }\n  }\n\n  if (typeof window.CustomEvent !== 'function') {\n    const originPreventDefault = window.Event.prototype.preventDefault\n\n    createCustomEvent = (eventName, params) => {\n      const evt = document.createEvent('CustomEvent')\n\n      params = params || { bubbles: false, cancelable: false, detail: null }\n      evt.initCustomEvent(eventName, params.bubbles, params.cancelable, params.detail)\n      evt.preventDefault = function () {\n        if (!this.cancelable) {\n          return\n        }\n\n        originPreventDefault.call(this)\n        Object.defineProperty(this, 'defaultPrevented', {\n          get: function () { return true }\n        })\n      }\n\n      return evt\n    }\n  }\n}\n\npolyfill()\n\nexport {\n  closest,\n  WinEvent,\n  createCustomEvent\n}\n","import { WinEvent, createCustomEvent } from './polyfill'\r\n\r\nconst MILLISECONDS_MULTIPLIER = 1000\r\n\r\nconst ClassName = {\r\n  ACTIVE: 'active',\r\n  LINEAR: 'linear',\r\n  BLOCK: 'dstepper-block',\r\n  NONE: 'dstepper-none',\r\n  FADE: 'fade'\r\n}\r\n\r\nconst transitionEndEvent = 'transitionend'\r\nconst customProperty = 'bsStepper'\r\n\r\nconst show = (stepperNode, indexStep, options, done) => {\r\n  const stepper = stepperNode[customProperty]\r\n\r\n  if (stepper._steps[indexStep].classList.contains(ClassName.ACTIVE) || stepper._stepsContents[indexStep].classList.contains(ClassName.ACTIVE)) {\r\n    return\r\n  }\r\n\r\n  const showEvent = createCustomEvent('show.bs-stepper', {\r\n    cancelable: true,\r\n    detail: {\r\n      indexStep\r\n    }\r\n  })\r\n  stepperNode.dispatchEvent(showEvent)\r\n\r\n  const activeStep = stepper._steps.filter(step => step.classList.contains(ClassName.ACTIVE))\r\n  const activeContent = stepper._stepsContents.filter(content => content.classList.contains(ClassName.ACTIVE))\r\n\r\n  if (showEvent.defaultPrevented) {\r\n    return\r\n  }\r\n\r\n  if (activeStep.length) {\r\n    activeStep[0].classList.remove(ClassName.ACTIVE)\r\n  }\r\n  if (activeContent.length) {\r\n    activeContent[0].classList.remove(ClassName.ACTIVE)\r\n    activeContent[0].classList.remove(ClassName.BLOCK)\r\n  }\r\n\r\n  showStep(stepperNode, stepper._steps[indexStep], stepper._steps, options)\r\n  showContent(stepperNode, stepper._stepsContents[indexStep], stepper._stepsContents, activeContent, done)\r\n}\r\n\r\nconst showStep = (stepperNode, step, stepList, options) => {\r\n  stepList.forEach(step => {\r\n    const trigger = step.querySelector(options.selectors.trigger)\r\n\r\n    trigger.setAttribute('aria-selected', 'false')\r\n    // if stepper is in linear mode, set disabled attribute on the trigger\r\n    if (stepperNode.classList.contains(ClassName.LINEAR)) {\r\n      trigger.setAttribute('disabled', 'disabled')\r\n    }\r\n  })\r\n\r\n  step.classList.add(ClassName.ACTIVE)\r\n  const currentTrigger = step.querySelector(options.selectors.trigger)\r\n\r\n  currentTrigger.setAttribute('aria-selected', 'true')\r\n  // if stepper is in linear mode, remove disabled attribute on current\r\n  if (stepperNode.classList.contains(ClassName.LINEAR)) {\r\n    currentTrigger.removeAttribute('disabled')\r\n  }\r\n}\r\n\r\nconst showContent = (stepperNode, content, contentList, activeContent, done) => {\r\n  const shownEvent = createCustomEvent('shown.bs-stepper', {\r\n    cancelable: true,\r\n    detail: {\r\n      indexStep: contentList.indexOf(content)\r\n    }\r\n  })\r\n\r\n  function complete () {\r\n    content.classList.add(ClassName.BLOCK)\r\n    content.removeEventListener(transitionEndEvent, complete)\r\n    stepperNode.dispatchEvent(shownEvent)\r\n    done()\r\n  }\r\n\r\n  if (content.classList.contains(ClassName.FADE)) {\r\n    content.classList.remove(ClassName.NONE)\r\n    const duration = getTransitionDurationFromElement(content)\r\n\r\n    content.addEventListener(transitionEndEvent, complete)\r\n    if (activeContent.length) {\r\n      activeContent[0].classList.add(ClassName.NONE)\r\n    }\r\n\r\n    content.classList.add(ClassName.ACTIVE)\r\n    emulateTransitionEnd(content, duration)\r\n  } else {\r\n    content.classList.add(ClassName.ACTIVE)\r\n    stepperNode.dispatchEvent(shownEvent)\r\n    done()\r\n  }\r\n}\r\n\r\nconst getTransitionDurationFromElement = element => {\r\n  if (!element) {\r\n    return 0\r\n  }\r\n\r\n  // Get transition-duration of the element\r\n  let transitionDuration = window.getComputedStyle(element).transitionDuration\r\n  const floatTransitionDuration = parseFloat(transitionDuration)\r\n\r\n  // Return 0 if element or transition duration is not found\r\n  if (!floatTransitionDuration) {\r\n    return 0\r\n  }\r\n\r\n  // If multiple durations are defined, take the first\r\n  transitionDuration = transitionDuration.split(',')[0]\r\n\r\n  return parseFloat(transitionDuration) * MILLISECONDS_MULTIPLIER\r\n}\r\n\r\nconst emulateTransitionEnd = (element, duration) => {\r\n  let called = false\r\n  const durationPadding = 5\r\n  const emulatedDuration = duration + durationPadding\r\n  function listener () {\r\n    called = true\r\n    element.removeEventListener(transitionEndEvent, listener)\r\n  }\r\n\r\n  element.addEventListener(transitionEndEvent, listener)\r\n  window.setTimeout(() => {\r\n    if (!called) {\r\n      element.dispatchEvent(WinEvent(transitionEndEvent))\r\n    }\r\n\r\n    element.removeEventListener(transitionEndEvent, listener)\r\n  }, emulatedDuration)\r\n}\r\n\r\nconst detectAnimation = (contentList, options) => {\r\n  if (options.animation) {\r\n    contentList.forEach(content => {\r\n      content.classList.add(ClassName.FADE)\r\n      content.classList.add(ClassName.NONE)\r\n    })\r\n  }\r\n}\r\n\r\nexport {\r\n  show,\r\n  ClassName,\r\n  customProperty,\r\n  detectAnimation\r\n}\r\n","import { closest } from './polyfill'\r\nimport { customProperty, show } from './util'\r\n\r\nconst buildClickStepLinearListener = () => function clickStepLinearListener (event) {\r\n  event.preventDefault()\r\n}\r\n\r\nconst buildClickStepNonLinearListener = options => function clickStepNonLinearListener (event) {\r\n  event.preventDefault()\r\n\r\n  const step = closest(event.target, options.selectors.steps)\r\n  const stepperNode = closest(step, options.selectors.stepper)\r\n  const stepper = stepperNode[customProperty]\r\n  const stepIndex = stepper._steps.indexOf(step)\r\n\r\n  show(stepperNode, stepIndex, options, () => {\r\n    stepper._currentIndex = stepIndex\r\n  })\r\n}\r\n\r\nexport {\r\n  buildClickStepLinearListener,\r\n  buildClickStepNonLinearListener\r\n}\r\n","import { show, customProperty, detectAnimation, ClassName } from './util'\r\nimport { buildClickStepLinearListener, buildClickStepNonLinearListener } from './listeners'\r\n\r\nconst DEFAULT_OPTIONS = {\r\n  linear: true,\r\n  animation: false,\r\n  selectors: {\r\n    steps: '.step',\r\n    trigger: '.step-trigger',\r\n    stepper: '.bs-stepper'\r\n  }\r\n}\r\n\r\nclass Stepper {\r\n  constructor (element, _options = {}) {\r\n    this._element = element\r\n    this._currentIndex = 0\r\n    this._stepsContents = []\r\n\r\n    this.options = {\r\n      ...DEFAULT_OPTIONS,\r\n      ..._options\r\n    }\r\n\r\n    this.options.selectors = {\r\n      ...DEFAULT_OPTIONS.selectors,\r\n      ...this.options.selectors\r\n    }\r\n\r\n    if (this.options.linear) {\r\n      this._element.classList.add(ClassName.LINEAR)\r\n    }\r\n\r\n    this._steps = [].slice.call(this._element.querySelectorAll(this.options.selectors.steps))\r\n\r\n    this._steps.filter(step => step.hasAttribute('data-target'))\r\n      .forEach(step => {\r\n        this._stepsContents.push(\r\n          this._element.querySelector(step.getAttribute('data-target'))\r\n        )\r\n      })\r\n\r\n    detectAnimation(this._stepsContents, this.options)\r\n    this._setLinkListeners()\r\n    Object.defineProperty(this._element, customProperty, {\r\n      value: this,\r\n      writable: true\r\n    })\r\n\r\n    if (this._steps.length) {\r\n      show(this._element, this._currentIndex, this.options, () => {})\r\n    }\r\n  }\r\n\r\n  // Private\r\n\r\n  _setLinkListeners () {\r\n    this._steps.forEach(step => {\r\n      const trigger = step.querySelector(this.options.selectors.trigger)\r\n\r\n      if (this.options.linear) {\r\n        this._clickStepLinearListener = buildClickStepLinearListener(this.options)\r\n        trigger.addEventListener('click', this._clickStepLinearListener)\r\n      } else {\r\n        this._clickStepNonLinearListener = buildClickStepNonLinearListener(this.options)\r\n        trigger.addEventListener('click', this._clickStepNonLinearListener)\r\n      }\r\n    })\r\n  }\r\n\r\n  // Public\r\n\r\n  next () {\r\n    const nextStep = (this._currentIndex + 1) <= this._steps.length - 1 ? this._currentIndex + 1 : (this._steps.length - 1)\r\n\r\n    show(this._element, nextStep, this.options, () => {\r\n      this._currentIndex = nextStep\r\n    })\r\n  }\r\n\r\n  previous () {\r\n    const previousStep = (this._currentIndex - 1) >= 0 ? this._currentIndex - 1 : 0\r\n\r\n    show(this._element, previousStep, this.options, () => {\r\n      this._currentIndex = previousStep\r\n    })\r\n  }\r\n\r\n  to (stepNumber) {\r\n    const tempIndex = stepNumber - 1\r\n    const nextStep = tempIndex >= 0 && tempIndex < this._steps.length\r\n      ? tempIndex\r\n      : 0\r\n\r\n    show(this._element, nextStep, this.options, () => {\r\n      this._currentIndex = nextStep\r\n    })\r\n  }\r\n\r\n  reset () {\r\n    show(this._element, 0, this.options, () => {\r\n      this._currentIndex = 0\r\n    })\r\n  }\r\n\r\n  destroy () {\r\n    this._steps.forEach(step => {\r\n      const trigger = step.querySelector(this.options.selectors.trigger)\r\n\r\n      if (this.options.linear) {\r\n        trigger.removeEventListener('click', this._clickStepLinearListener)\r\n      } else {\r\n        trigger.removeEventListener('click', this._clickStepNonLinearListener)\r\n      }\r\n    })\r\n\r\n    this._element[customProperty] = undefined\r\n    this._element = undefined\r\n    this._currentIndex = undefined\r\n    this._steps = undefined\r\n    this._stepsContents = undefined\r\n    this._clickStepLinearListener = undefined\r\n    this._clickStepNonLinearListener = undefined\r\n  }\r\n}\r\n\r\nexport default Stepper\r\n"],"names":["matches","window","Element","prototype","closest","element","selector","WinEvent","inType","params","Event","createCustomEvent","eventName","cEvent","CustomEvent","polyfill","msMatchesSelector","webkitMatchesSelector","document","documentElement","contains","call","parentElement","parentNode","nodeType","e","createEvent","initEvent","Boolean","bubbles","cancelable","originPreventDefault","preventDefault","evt","detail","initCustomEvent","Object","defineProperty","get","MILLISECONDS_MULTIPLIER","ClassName","ACTIVE","LINEAR","BLOCK","NONE","FADE","transitionEndEvent","customProperty","show","stepperNode","indexStep","options","done","stepper","_steps","classList","_stepsContents","showEvent","dispatchEvent","activeStep","filter","step","activeContent","content","defaultPrevented","length","remove","showStep","showContent","stepList","forEach","trigger","querySelector","selectors","setAttribute","add","currentTrigger","removeAttribute","contentList","shownEvent","indexOf","complete","removeEventListener","duration","getTransitionDurationFromElement","addEventListener","emulateTransitionEnd","transitionDuration","getComputedStyle","floatTransitionDuration","parseFloat","split","called","durationPadding","emulatedDuration","listener","setTimeout","detectAnimation","animation","buildClickStepLinearListener","clickStepLinearListener","event","buildClickStepNonLinearListener","clickStepNonLinearListener","target","steps","stepIndex","_currentIndex","DEFAULT_OPTIONS","linear","Stepper","_options","_element","slice","querySelectorAll","hasAttribute","push","getAttribute","_setLinkListeners","value","writable","_clickStepLinearListener","_clickStepNonLinearListener","next","nextStep","previous","previousStep","to","stepNumber","tempIndex","reset","destroy","undefined"],"mappings":"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"}